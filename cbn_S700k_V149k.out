cpu-bind=MASK - rishon3, task  0  0 [12661]: mask 0x200000002 set
cpu-bind=MASK - rishon3, task  0  0 [12661]: mask 0x200000002 set
Will save checkpoints to data/film.pt
Reading features from data/train_features.h5
Reading questions from  data/train_questions.h5
Reading question data into memory
Reading features from data/val_features.h5
Reading questions from  data/val_questions.h5
Reading question data into memory
device count = 2
Here is the conditioning network:
DataParallel (
  (module): FiLMGen (
    (encoder_embed): Embedding(93, 200)
    (encoder_rnn): GRU(200, 4096, batch_first=True)
    (decoder_linear): Linear (4096 -> 2048)
  )
)
Here is the conditioned network:
FiLMedNet (
  (stem): Sequential (
    (0): Conv2d(1026, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True)
    (2): ReLU (inplace)
  )
  (0): FiLMedResBlock (
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False)
    (film): FiLM (
    )
    (cbn): CBN (
    )
  )
  (1): FiLMedResBlock (
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False)
    (film): FiLM (
    )
    (cbn): CBN (
    )
  )
  (2): FiLMedResBlock (
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False)
    (film): FiLM (
    )
    (cbn): CBN (
    )
  )
  (3): FiLMedResBlock (
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False)
    (film): FiLM (
    )
    (cbn): CBN (
    )
  )
  (classifier): Sequential (
    (0): Conv2d(130, 512, kernel_size=(1, 1), stride=(1, 1))
    (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True)
    (2): ReLU (inplace)
    (3): MaxPool2d (size=(14, 14), stride=(14, 14), dilation=(1, 1))
    (4): Flatten (
    )
    (5): Linear (512 -> 1024)
    (6): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (7): ReLU (inplace)
    (8): Linear (1024 -> 32)
  )
)
train_loader has 699989 samples
val_loader has 149991 samples
Starting epoch 1
100 1.6913964068889618
200 1.0954248470067978
300 1.0655715054273605
400 1.0560154169797897
500 1.0490751153230666
600 1.0277585256099702
700 1.021822807788849
800 1.0231272709369659
900 1.0120629620552064
1000 1.0232118904590606
1100 1.0149154990911484
1200 1.0071920293569565
1300 1.0131843620538712
1400 0.9894590884447098
1500 0.9929556924104691
1600 1.009579227566719
1700 0.9972227865457535
1800 0.997742914557457
1900 0.9895967710018158
2000 0.9799865299463272
2100 0.9936231374740601
2200 0.9920501059293747
2300 0.9847019392251969
2400 0.9924176663160325
2500 0.9750153321027756
2600 0.9814202380180359
2700 0.995062375664711
2800 0.9914713442325592
2900 0.9743132930994034
3000 0.9822979158163071
3100 0.9602118700742721
3200 0.9865781098604203
3300 0.9764119625091553
3400 0.9773117536306382
3500 0.9804861402511597
3600 0.9776631671190262
3700 0.9588283783197403
3800 0.9846531826257706
3900 0.9553774631023407
4000 0.9753895777463913
4100 0.9669304049015045
4200 0.965860189795494
4300 0.9671095478534698
4400 0.9746804773807526
4500 0.9651801288127899
4600 0.9627491015195847
4700 0.9630538910627365
4800 0.9622823160886764
4900 0.9618540406227112
5000 0.9710679507255554
5100 0.9645634537935257
5200 0.9639469289779663
5300 0.9709888619184494
5400 0.9607952803373336
5500 0.9557347440719605
5600 0.9567532610893249
5700 0.9623590075969696
5800 0.9619303584098816
5900 0.954431704878807
6000 0.9514253288507462
6100 0.9694428580999375
6200 0.9663861280679703
6300 0.9582505041360855
6400 0.9788909083604813
6500 0.96455138027668
6600 0.9631541645526887
6700 0.9555862271785736
6800 0.9572000354528427
6900 0.9529092961549759
7000 0.9618008321523667
7100 0.9538785219192505
7200 0.9619517803192139
7300 0.966995297074318
7400 0.9471879625320434
7500 0.9499742937088013
7600 0.9707361203432083
7700 0.9665012097358704
7800 0.9703712129592895
7900 0.9591754519939423
8000 0.9458310204744339
8100 0.9537062716484069
8200 0.9473860520124435
8300 0.9478140723705292
8400 0.9572626811265945
8500 0.9458087801933288
8600 0.9519150394201279
8700 0.9477490621805191
8800 0.9480429708957672
8900 0.9502443331480026
9000 0.9559519547224045
9100 0.9501964992284775
9200 0.9548849803209305
9300 0.9512385046482086
9400 0.9719584649801254
9500 0.9390828108787537
9600 0.9543592774868012
9700 0.9600664061307908
9800 0.953340956568718
9900 0.9475211870670318
10000 0.9663241416215896
10100 0.9519313007593155
10200 0.9548023670911789
10300 0.9481512087583542
10400 0.9659519577026368
10500 0.9396514165401458
10600 0.9562431234121322
10700 0.9343399530649186
10800 0.9507852184772492
10900 0.955249947309494
[37mEPOCH PASS AVG TIME: 4487.931023597717[0m
[37mEpoch Pass Time      : 4487.931023597717[0m
Starting epoch 2
11000 0.9426901191473007
11100 0.9419268780946731
11200 0.9524627184867859
11300 0.9366094547510148
11400 0.9451360511779785
11500 0.9610528790950775
11600 0.9500886958837509
11700 0.9447191894054413
11800 0.9358525955677033
11900 0.9330296033620834
12000 0.9387961506843567
12100 0.9390601950883866
12200 0.9461453652381897
12300 0.9329547375440598
12400 0.9365494453907013
12500 0.9387600207328797
12600 0.9493122190237046
12700 0.9418342816829681
12800 0.955295518040657
12900 0.9456705641746521
13000 0.9371903783082962
13100 0.9427150309085846
13200 0.9337119883298874
13300 0.9331633216142654
13400 0.9490910404920578
13500 0.9441557222604752
13600 0.9302249950170517
13700 0.9457106244564056
13800 0.9393777364492416
13900 0.9294072043895721
14000 0.9332206445932388
14100 0.9459714388847351
14200 0.9537289535999298
14300 0.9464913129806518
14400 0.937326243519783
14500 0.9394806671142578
14600 0.9349537366628646
14700 0.9304194420576095
14800 0.932331559062004
14900 0.9393586200475693
15000 0.9250206434726715
15100 0.928828632235527
15200 0.9331695377826691
15300 0.9424215716123581
15400 0.9346196681261063
15500 0.9265290755033493
15600 0.9411911785602569
15700 0.9247321307659149
15800 0.9357554572820663
15900 0.9228929269313813
16000 0.9197430890798569
16100 0.9442413204908371
16200 0.9398045027256012
16300 0.9187889117002487
16400 0.9275274902582169
16500 0.9531181329488754
16600 0.9183501172065734
16700 0.9226724803447723
16800 0.9335795569419861
16900 0.9263701468706131
17000 0.9222595918178559
17100 0.9275334358215332
17200 0.9221045976877212
17300 0.9303110182285309
17400 0.9324262803792953
17500 0.924333975315094
17600 0.9163098824024201
17700 0.920887195467949
17800 0.9275699388980866
17900 0.9281925559043884
18000 0.9277296835184097
18100 0.935982819199562
18200 0.9204397892951965
18300 0.9322151523828507
18400 0.926154191493988
18500 0.9248604494333267
18600 0.9152781176567077
18700 0.9381827527284622
18800 0.9388564777374268
18900 0.9247316157817841
19000 0.9167382138967514
19100 0.9205740773677826
19200 0.9140307348966599
19300 0.9211813730001449
19400 0.9232392084598541
19500 0.915834698677063
19600 0.9192664229869842
19700 0.9256815028190613
19800 0.9174245238304138
19900 0.9157389467954635
20000 0.9191377580165863
20100 0.9010365343093872
20200 0.9085313230752945
20300 0.9077403444051743
20400 0.9220920991897583
20500 0.9100635242462158
20600 0.9114623516798019
20700 0.9115293610095978
20800 0.9200808155536652
20900 0.9092175787687302
21000 0.9233019608259201
21100 0.9089063102006912
21200 0.9191092491149903
21300 0.922995131611824
21400 0.912278932929039
21500 0.9125359040498734
21600 0.9058913683891296
21700 0.9213204026222229
21800 0.9076120609045029
[37mEPOCH PASS AVG TIME: 4171.130885958672[0m
[37mEpoch Pass Time      : 3854.330748319626[0m
Starting epoch 3
21900 0.9156837147474289
22000 0.9127224278450012
22100 0.907853479385376
22200 0.8993589395284652
22300 0.913992378115654
22400 0.9159779077768326
22500 0.9011187809705734
22600 0.9043466764688491
22700 0.9100364643335342
22800 0.9135016709566116
22900 0.9106456804275512
23000 0.9034617400169372
23100 0.8972227317094803
23200 0.9159340560436249
23300 0.9219946545362473
23400 0.8985691893100739
23500 0.9075702035427093
23600 0.9118763130903244
23700 0.9066959583759308
23800 0.9086386597156525
23900 0.9053943204879761
24000 0.9014293891191483
24100 0.9007282418012619
24200 0.9086654490232468
24300 0.9008058947324753
24400 0.9070432025194168
24500 0.9081073719263076
24600 0.9196386855840682
24700 0.9037233877182007
24800 0.9065328699350357
24900 0.8923977988958359
25000 0.9119340395927429
25100 0.9070824539661407
25200 0.9018280392885208
25300 0.9033110135793686
25400 0.9004079973697663
25500 0.8923568284511566
25600 0.9279666602611542
25700 0.9082944065332412
25800 0.8944028222560882
25900 0.9168411767482758
26000 0.9027255654335022
26100 0.9130632781982422
26200 0.895349383354187
26300 0.8955914092063904
26400 0.9046949046850205
26500 0.8958852595090866
26600 0.9068413776159286
26700 0.9038122493028641
26800 0.900951229929924
26900 0.9042083632946014
27000 0.9180150431394577
27100 0.9037562447786331
27200 0.9003034633398056
27300 0.8998357486724854
27400 0.8941088277101517
27500 0.9015107691287995
27600 0.9003091031312942
27700 0.903079332113266
27800 0.8852096164226532
27900 0.9063285166025161
28000 0.9006069648265839
28100 0.9103167355060577
28200 0.9100336611270905
28300 0.9029710966348649
28400 0.8927558141946793
28500 0.889308066368103
28600 0.9026212757825851
28700 0.8930264526605606
28800 0.9040625840425491
28900 0.9005725055932998
29000 0.8883257013559341
29100 0.8990094012022019
29200 0.8862460523843765
29300 0.8867812204360962
29400 0.9030195504426957
29500 0.8858813846111298
29600 0.9012460029125213
29700 0.8993082195520401
29800 0.8930311536788941
29900 0.8706031095981598
30000 0.8877828592061996
30100 0.909791641831398
30200 0.8895697784423828
30300 0.8900640380382537
30400 0.8852096182107926
30500 0.87739790558815
30600 0.8899860566854477
30700 0.8961830031871796
30800 0.885602862238884
30900 0.8948126578330994
31000 0.8815733355283737
31100 0.8772964739799499
31200 0.8750200843811036
31300 0.887891350388527
31400 0.8880770820379257
31500 0.8722050654888153
31600 0.885703250169754
31700 0.8782829576730729
31800 0.8853755134344101
31900 0.872035568356514
32000 0.8730025058984756
32100 0.8830404978990555
32200 0.8638237482309341
32300 0.8736948692798614
32400 0.8536087822914123
32500 0.8670059585571289
32600 0.8671613013744355
32700 0.8657799053192139
32800 0.8742306518554688
[37mEPOCH PASS AVG TIME: 4079.6305924256644[0m
[37mEpoch Pass Time      : 3896.6300053596497[0m
Starting epoch 4
32900 0.8702131283283233
33000 0.8654394257068634
33100 0.8525368547439576
33200 0.8605513393878936
33300 0.8516039794683457
33400 0.859571184515953
33500 0.8472732323408126
33600 0.8720260554552078
33700 0.8537512004375458
33800 0.8612540405988693
33900 0.8528252047300339
34000 0.8590651267766952
34100 0.8534087443351746
34200 0.8535189652442932
34300 0.849935821890831
34400 0.8478910034894943
34500 0.837790567278862
34600 0.8431182551383972
34700 0.8359861934185028
34800 0.843519327044487
34900 0.8382143712043763
35000 0.8425885409116745
35100 0.8448436307907105
35200 0.8291063368320465
35300 0.8373728686571121
35400 0.8225835150480271
35500 0.8444903200864792
35600 0.834584396481514
35700 0.8230744642019272
35800 0.8219816082715988
35900 0.820392307639122
36000 0.8312514895200729
36100 0.8275118136405945
36200 0.8319999885559082
36300 0.80731853723526
36400 0.8200124287605286
36500 0.809735437631607
36600 0.8136225014925003
36700 0.8197921603918076
36800 0.8014285725355148
36900 0.8144892060756683
37000 0.8042820864915847
37100 0.8066617178916932
37200 0.8043105727434159
37300 0.8047021555900574
37400 0.8038130313158035
37500 0.790897091627121
37600 0.797430756688118
37700 0.7945465266704559
37800 0.810212355852127
37900 0.7733459788560867
38000 0.7810777270793915
38100 0.7960703372955322
38200 0.787213254570961
38300 0.7905944681167603
38400 0.7937512576580048
38500 0.7906256794929505
38600 0.8005018603801727
38700 0.780771946310997
38800 0.7869794976711273
38900 0.7755681169033051
39000 0.7724031287431717
39100 0.7644853281974793
39200 0.7809949088096618
39300 0.7706966370344162
39400 0.7756514656543732
39500 0.7640938460826874
39600 0.7822198015451431
39700 0.759884974360466
39800 0.7729359948635102
39900 0.777684502005577
40000 0.7674718314409256
40100 0.7553075605630875
40200 0.7557212293148041
40300 0.748483162522316
40400 0.7522785437107086
40500 0.7716916054487228
40600 0.7578323650360107
40700 0.7585361576080323
40800 0.7708043384552002
40900 0.7667931634187698
41000 0.7560470688343048
41100 0.7560206621885299
41200 0.7593593370914459
41300 0.7570020890235901
41400 0.7432396179437637
41500 0.7673337608575821
41600 0.7579541146755219
41700 0.7565678966045379
41800 0.745098443031311
41900 0.7436639773845672
42000 0.7550116288661957
42100 0.7426193565130234
42200 0.7455106490850448
42300 0.7461426150798798
42400 0.7465721434354782
42500 0.7404817396402359
42600 0.7480040663480758
42700 0.7360718142986298
42800 0.7295831590890884
42900 0.748369169831276
43000 0.7372144347429276
43100 0.7373081260919571
43200 0.739970977306366
43300 0.7253496837615967
43400 0.7338058596849442
43500 0.7382938802242279
43600 0.7231117850542068
43700 0.7306677359342575
[37mEPOCH PASS AVG TIME: 4047.2818576693535[0m
[37mEpoch Pass Time      : 3950.235653400421[0m
Starting epoch 5
43800 0.7261826056241989
43900 0.7274656373262406
44000 0.7266420257091523
44100 0.727433408498764
44200 0.7173492032289505
44300 0.718679780960083
44400 0.730029855966568
44500 0.7315335887670517
44600 0.7162348079681397
44700 0.7005705404281616
44800 0.7132619267702103
44900 0.7140722793340682
45000 0.7106110268831253
45100 0.6937286531925202
45200 0.7204153203964233
45300 0.7234174984693528
45400 0.708120327591896
45500 0.7121368944644928
45600 0.6908891582489014
45700 0.6945868384838104
45800 0.7077835047245026
45900 0.694239376783371
46000 0.6853756988048554
46100 0.7115121620893479
46200 0.7094106948375702
46300 0.6961380958557128
46400 0.698354977965355
46500 0.6940765643119812
46600 0.7037373420596122
46700 0.6732388687133789
46800 0.701560178399086
46900 0.6685454958677292
47000 0.6746230000257492
47100 0.6870513886213303
47200 0.6609132468700409
47300 0.6741833901405334
47400 0.6763137197494506
47500 0.664604372382164
47600 0.658839828968048
47700 0.6608803468942642
47800 0.6763705271482467
47900 0.6640384936332703
48000 0.6679214328527451
48100 0.6681939685344696
48200 0.6680823659896851
48300 0.6593609088659287
48400 0.660536929666996
48500 0.6736744314432144
48600 0.6543931049108506
48700 0.6349829569458961
48800 0.6471136826276779
48900 0.6590274327993393
49000 0.6574001723527908
49100 0.6618057093024254
49200 0.6564356404542923
49300 0.6484654605388641
49400 0.6334061005711555
49500 0.6487605684995651
49600 0.6323030370473862
49700 0.6329072219133377
49800 0.6492780834436417
49900 0.6360634875297546
50000 0.642006688117981
50100 0.620906523168087
50200 0.6219665968418121
50300 0.6335174623131752
50400 0.6323316094279289
50500 0.6427515283226967
50600 0.6265023711323738
50700 0.6363802215456963
50800 0.6316898849606514
50900 0.620227108001709
51000 0.6476885312795639
51100 0.6183976066112519
51200 0.6221378535032273
51300 0.6237371626496315
51400 0.6480944561958313
51500 0.6380373248457909
51600 0.6267463162541389
51700 0.6419726443290711
51800 0.6300829166173935
51900 0.6183926919102669
52000 0.6306670290231705
52100 0.6398088818788529
52200 0.613086841404438
52300 0.624776017665863
52400 0.6227956479787826
52500 0.6195514118671417
52600 0.6256183433532715
52700 0.6148502480983734
52800 0.6223041868209839
52900 0.6287130531668663
53000 0.620987129509449
53100 0.6159335577487945
53200 0.6089078441262246
53300 0.6120244216918945
53400 0.6220054244995117
53500 0.6105953454971313
53600 0.6213147562742233
53700 0.6046708089113235
53800 0.6055080389976502
53900 0.6032410261034965
54000 0.5975986841320992
54100 0.61217493891716
54200 0.6044696420431137
54300 0.6098735159635544
54400 0.6165614405274391
54500 0.6131937268376351
54600 0.5903055846691132
[37mEPOCH PASS AVG TIME: 4030.2126893997192[0m
[37mEpoch Pass Time      : 3961.9360163211823[0m
Starting epoch 6
54700 0.6025761157274246
54800 0.580258766412735
54900 0.5828092351555825
55000 0.5920580977201462
55100 0.5915234133601188
55200 0.5811849510669709
55300 0.5813938054442406
55400 0.6098233950138092
55500 0.5978190889954567
55600 0.5971033737063408
55700 0.5877545371651649
55800 0.5943776488304138
55900 0.589840185046196
56000 0.5989596730470658
56100 0.5919133532047272
56200 0.5904573062062264
56300 0.5854132479429245
56400 0.5815394595265388
56500 0.5779489007592201
56600 0.5919884356856346
56700 0.5832434687018394
56800 0.5731694820523262
56900 0.5862419137358665
57000 0.581255125105381
57100 0.5829863625764847
57200 0.5813726791739464
57300 0.57512437582016
57400 0.5775503647327423
57500 0.5730124896764756
57600 0.5715039458870887
57700 0.5802311354875564
57800 0.5710798433423042
57900 0.5704280367493629
58000 0.5702797710895539
58100 0.5711881405115128
58200 0.5596905627846718
58300 0.5787671676278114
58400 0.5661476555466652
58500 0.5701860848069191
58600 0.562228508591652
58700 0.5682009887695313
58800 0.5736541068553924
58900 0.5589918005466461
59000 0.5554320970177651
59100 0.5465879571437836
59200 0.5508359155058861
59300 0.5389854314923287
59400 0.5530214694142341
59500 0.5566598516702652
59600 0.5367968600988388
59700 0.5463802021741867
59800 0.545020278096199
59900 0.5373997688293457
60000 0.5414307051897049
60100 0.5433591929078102
60200 0.5400540292263031
60300 0.5413397935032844
60400 0.5310439556837082
60500 0.5292088571190834
60600 0.5305382516980172
60700 0.5329930579662323
60800 0.5300356623530388
60900 0.5225097078084946
61000 0.5271003249287606
61100 0.5247868746519089
61200 0.5230821880698204
61300 0.5215890941023826
61400 0.5323756983876229
61500 0.5284944626688958
61600 0.5112400391697883
61700 0.5205604192614556
61800 0.5285604125261307
61900 0.5280906671285629
62000 0.5195634585618972
62100 0.516436878144741
62200 0.5411029261350632
62300 0.5173812037706376
62400 0.5350544261932373
62500 0.5373656344413758
62600 0.5058613705635071
62700 0.518018727004528
62800 0.5097161090373993
62900 0.5088030815124511
63000 0.5258860060572624
63100 0.5044515436887741
63200 0.5132497000694275
63300 0.507208651304245
63400 0.5180036118626594
63500 0.5210761934518814
63600 0.5271593797206878
63700 0.5063643705844879
63800 0.5159175056219101
63900 0.4958355936408043
64000 0.49352694422006604
64100 0.4954035559296608
64200 0.5058943369984626
64300 0.5075477540493012
64400 0.5091931527853012
64500 0.5071847322583198
64600 0.4985008999705315
64700 0.4973739951848984
64800 0.503366062939167
64900 0.48638036161661147
65000 0.48415188372135165
65100 0.49593044966459277
65200 0.5061712929606438
65300 0.5031596884131432
65400 0.4802573710680008
65500 0.5050619930028916
65600 0.5101566675305367
[37mEPOCH PASS AVG TIME: 4017.217217127482[0m
[37mEpoch Pass Time      : 3952.2398557662964[0m
Starting epoch 7
slurmstepd-rishon3: error: *** JOB 178227 ON rishon3 CANCELLED AT 2019-09-19T15:58:22 ***
